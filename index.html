<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dividir e Mesclar Texto</title>
    <style>
        textarea {
            width: 100%;
            height: 200px;
        }
    </style>
</head>
<body>
    <h2>Dividir e Mesclar Texto</h2>
    <textarea id="inputText" placeholder="Cole seu texto aqui..."></textarea>
    <br>
    <label for="lines">NÃºmero de linhas por arquivo:</label>
    <input type="number" id="lines" value="80">
    <br>
    <button onclick="splitText()">Dividir Texto</button>
    <button onclick="mergeFiles()">Mesclar Arquivos</button>
    <button onclick="downloadMergedFile()">Baixar Arquivo Mesclado</button>
    <button onclick="downloadAllParts()">Baixar Todas as Partes</button>
    <div id="output"></div>

    <script>
        var mergedContent = '';
        var parts = [];

        function splitText() {
            var inputText = document.getElementById('inputText').value;
            var linesPerFile = parseInt(document.getElementById('lines').value);
            var lines = inputText.split('\n');
            var numFiles = Math.ceil(lines.length / linesPerFile);
            var outputDiv = document.getElementById('output');
            outputDiv.innerHTML = '';
            parts = [];

            for (var i = 0; i < numFiles; i++) {
                var startIndex = i * linesPerFile;
                var endIndex = Math.min((i + 1) * linesPerFile, lines.length);
                var fileContent = lines.slice(startIndex, endIndex).join('\n');
                var fileName = 'file_' + (i + 1) + '.txt';

                var link = document.createElement('a');
                link.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(fileContent));
                link.setAttribute('download', fileName);
                link.innerText = fileName;
                parts.push({ content: fileContent, name: fileName });
                
                var br = document.createElement('br');
                
                outputDiv.appendChild(link);
                outputDiv.appendChild(br);
            }
        }

        function mergeFiles() {
            var fileInputs = document.createElement('input');
            fileInputs.setAttribute('type', 'file');
            fileInputs.setAttribute('multiple', 'multiple');

            fileInputs.addEventListener('change', function() {
                mergedContent = '';

                Array.from(fileInputs.files).forEach(function(file) {
                    var reader = new FileReader();
                    reader.onload = function(e) {
                        mergedContent += e.target.result;
                    };
                    reader.readAsText(file);
                });

                var mergedTextArea = document.createElement('textarea');
                mergedTextArea.setAttribute('readonly', true);
                mergedTextArea.style.width = '100%';
                mergedTextArea.style.height = '200px';
                mergedTextArea.value = mergedContent;

                document.getElementById('output').innerHTML = '';
                document.getElementById('output').appendChild(mergedTextArea);
            });

            fileInputs.click();
        }

        function downloadMergedFile() {
            if (mergedContent !== '') {
                var blob = new Blob([mergedContent], { type: 'text/plain;charset=utf-8' });
                var fileName = 'merged_file.txt';

                var link = document.createElement('a');
                link.setAttribute('href', window.URL.createObjectURL(blob));
                link.setAttribute('download', fileName);
                link.style.display = 'none';
                
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
        }

        function downloadAllParts() {
            if (parts.length > 0) {
                var zip = new JSZip();

                parts.forEach(function(part) {
                    zip.file(part.name, part.content);
                });

                zip.generateAsync({ type: 'blob' })
                    .then(function(content) {
                        saveAs(content, 'all_parts.zip');
                    });
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.0/FileSaver.min.js"></script>
</body>
</html>
